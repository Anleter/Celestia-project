<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Celestia</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Unicase:wght@400;600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root { font-family: 'Inter', sans-serif; }
.dreamy-title { font-family: 'Cormorant Unicase', serif; }
/* Cloud animation */
.cloud {
  position: absolute;
  top: 50%;
  width: 600px;
  opacity: 0.6;
  animation: moveClouds 60s linear infinite;
}
.cloud:nth-child(2) { top: 40%; animation-duration: 90s; opacity: 0.4; }
@keyframes moveClouds { from { transform: translateX(-200px); } to { transform: translateX(100vw); } }
</style>
</head>
<body class="min-h-screen flex flex-col items-center bg-gradient-to-b from-[#87CEFA] via-[#B0E0E6] to-[#E0FFFF] overflow-y-scroll">

<!-- Animated Clouds -->
<img src="cloud.jpg.jpg" class="cloud" alt="cloud" width="500" height="600">
<img src="cloud.jpg.jpg" class="cloud" alt="cloud" width="500" height="600">

<!-- Background Video -->
<video id="video-background" autoplay loop muted playsinline style="position:fixed;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:-2"></video>

<!-- Header -->
<header class="text-center mt-8">
<h1 class="dreamy-title text-5xl font-bold text-white drop-shadow-lg">Celestia</h1>
<p class="text-white/90 text-lg">Your World • Your Weather • Your Story</p>
</header>

<!-- Search + Weather Info -->
<section class="bg-white/70 backdrop-blur-md rounded-2xl shadow-lg p-6 mt-6 w-11/12 md:w-3/4">
<div class="flex flex-col md:flex-row gap-4">
  <input id="city-input" type="text" placeholder="Search city/state/country" class="flex-1 p-3 rounded-xl border border-gray-300 focus:ring focus:ring-blue-300">
  <button onclick="searchCity()" class="px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600">Get Weather</button>
</div>
<div class="mt-4 text-center">
  <h2 id="weather-title" class="text-3xl font-bold text-blue-700"></h2>
  <p id="weather-temp" class="text-lg text-gray-700"></p>
</div>

<!-- Spotify Player -->
<iframe id="spotifyFrame" style="border-radius:12px" src="" width="100%" height="80" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
</section>

<!-- Mood Upload Section -->
<section class="bg-white/70 backdrop-blur-md rounded-2xl shadow-lg p-6 mt-6 w-11/12 md:w-3/4 text-center">
<h3 class="text-xl font-bold text-gray-800">Upload Your Weather Mood</h3>
<textarea id="mood-input" placeholder="Describe your mood today..." class="w-full mt-3 p-3 rounded-xl border border-gray-300"></textarea>
<button onclick="uploadMood()" class="mt-3 px-6 py-2 bg-yellow-500 rounded-full text-white font-semibold hover:bg-orange-400">Post Mood</button>
<div id="mood-feed" class="mt-4 flex flex-col gap-3"></div>
</section>

<!-- Hurricane & News Section -->
<section class="bg-white/70 backdrop-blur-md rounded-2xl shadow-lg p-6 mt-6 w-11/12 md:w-3/4">
<h3 class="text-2xl font-bold text-gray-800 mb-4">Hurricane & Weather News</h3>
<ul id="news-list" class="list-disc pl-6 text-gray-700">
  <li><a href="https://www.nhc.noaa.gov/" target="_blank" class="text-blue-600 underline">Hurricane Center Alerts</a></li>
  <li><a href="https://www.weather.com/news" target="_blank" class="text-blue-600 underline">Latest Weather News</a></li>
  <li><a href="https://www.nasa.gov/topics/earth/index.html" target="_blank" class="text-blue-600 underline">NASA Earth & Space Updates</a></li>
</ul>
</section>

<script>
const videoBg = document.getElementById("video-background");
const weatherTitle = document.getElementById("weather-title");
const weatherTemp = document.getElementById("weather-temp");
const spotifyFrame = document.getElementById("spotifyFrame");
const moodFeed = document.getElementById("mood-feed");

// English-only playlists by weather type
const playlists = {
  hot: "https://open.spotify.com/embed/playlist/37i9dQZF1DX1BzILRveYHb",
  cold: "https://open.spotify.com/embed/playlist/37i9dQZF1DX6VdMW310YC7",
  moderate: "https://open.spotify.com/embed/playlist/37i9dQZF1DXbvABJXBIyiY",
};

async function searchCity() {
  const city = document.getElementById("city-input").value || "Berlin";
  try {
    const geo = await fetch (`https://geocoding-api.open-meteo.com/v1/search?name=${city}`);
    const geoData = await geo.json();
    if (!geoData.results) { weatherTitle.textContent = "City not found"; return; }
    const { latitude, longitude, name } = geoData.results[0];
    getWeather(latitude, longitude, name);
  } catch(err) { console.error(err); }
}

async function getWeather(lat, lon, locationName) {
  try {
    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m`);
    const data = await res.json();
    const currentTemp = data.hourly.temperature_2m[0];
    weatherTitle.textContent = locationName;
    weatherTemp.textContent = `Temperature: ${currentTemp}°C`;

    // Spotify music based on temperature
    if (currentTemp >= 25) spotifyFrame.src = playlists.hot;
    else if (currentTemp <= 15) spotifyFrame.src = playlists.cold;
    else spotifyFrame.src = playlists.moderate;

    // Background video
    videoBg.src = currentTemp >= 25
      ? "https://cdn.glitch.me/.../sun.mp4"
      : currentTemp <= 15
      ? "https://cdn.glitch.me/.../snow.mp4"
      : "https://cdn.glitch.me/.../rain.mp4";

  } catch(err) { console.error(err); }
}

// Mood upload + likes
function uploadMood() {
  const moodText = document.getElementById("mood-input").value;
  if (!moodText) return;
  const moodEl = document.createElement("div");
  moodEl.className = "bg-white p-3 rounded-xl shadow flex justify-between items-center";
  moodEl.innerHTML = `<span>${moodText}</span> <button onclick="likeMood(this)" class="px-3 py-1 bg-pink-300 rounded-full">❤ <span>0</span></button>`;
  moodFeed.prepend(moodEl);
  document.getElementById("mood-input").value = "";
}

function likeMood(btn) {
  const countEl = btn.querySelector("span");
  let count = parseInt(countEl.textContent);
  count++;
  countEl.textContent = count;
  if (count >= 10) btn.style.background = "gold"; // star badge unlock
}

window.addEventListener("load", () => searchCity());
</script>
</body>
</html>